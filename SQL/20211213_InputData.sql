-- 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME = 'OBJECTION_STATE';


-- OBJECTION_STATE 테이블의 제약조건, 속성 삭제/추가
ALTER TABLE OBJECTION_STATE DROP CONSTRAINT SYS_C007421;

ALTER TABLE OBJECTION_STATE DROP COLUMN AD_ID;
ALTER TABLE OBJECTION_STATE DROP COLUMN STATENAME;
ALTER TABLE OBJECTION_STATE ADD NAME VARCHAR2(30);


-- OBJECTION 테이블의 속성, 제약조건 추가/삭제
ALTER TABLE OBJECTION ADD AD_ID VARCHAR2(30);
ALTER TABLE OBJECTION ADD CONFIRMDATE DATE;

ALTER TABLE OBJECTION 
ADD CONSTRAINT OBJECTION_AD_ID_FK FOREIGN KEY(AD_ID)
    REFERENCES ADMIN(AD_ID);

ALTER TABLE OBJECTION DROP CONSTRAINT SYS_C007491;

--------------------------------------------------------------------------------

-- SELLERREVIEW 테이블 생성
CREATE TABLE SELLERREVIEW 
( REVIEW_NO	    NUMBER	NOT NULL
, REGRADE_NO	NUMBER	NOT NULL
, BUYER_NO	    NUMBER	NOT NULL
, REVIEWDATE	DATE
, COMMENTS	    VARCHAR2(300)
, CONSTRAINT SELLERREVIEW_NO_PK PRIMARY KEY(REVIEW_NO)
, CONSTRAINT SELLERREVIEW_REGRADE_NO_FK FOREIGN KEY(REGRADE_NO)
             REFERENCES REVIEWGRADE(REGRADE_NO)
, CONSTRAINT SELLERREVIEW_BUYER_NO_FK FOREIGN KEY(BUYER_NO)
             REFERENCES BUYER(BUYER_NO)
);


-- SELLERREVIEWDETAIL 테이블 생성
CREATE TABLE SELLERREVIEWDETAIL 
( REDETAIL_NO	NUMBER	NOT NULL
, MSTICKER_NO	NUMBER	NOT NULL
, REVIEW_NO	    NUMBER	NOT NULL
, CONSTRAINT SELLERDETAIL_NO_PK PRIMARY KEY(REDETAIL_NO)
, CONSTRAINT SELLERDETAIL_MSTICKER_NO_FK FOREIGN KEY(MSTICKER_NO)
             REFERENCES MANNERSTICKER(MSTICKER_NO)
, CONSTRAINT SELLERDETAIL_REVIEW_NO_FK FOREIGN KEY(REVIEW_NO)
             REFERENCES SELLERREVIEW(REVIEW_NO)
);

--------------------------------------------------------------------------------

INSERT INTO ACCOUNT(AC_NO) VALUES(2);

--------------------------------------------------------------------------------

-- OBJECTION_STATE 테이블 데이터 추가
INSERT INTO OBJECTION_STATE(OBJSTAT_NO, NAME) VALUES(1, '구매자 과실');
INSERT INTO OBJECTION_STATE(OBJSTAT_NO, NAME) VALUES(2, '판매자 과실');

-- OBJECTIONWHY
INSERT INTO OBJECTIONWHY(OBJWHY_NO, WHY) VALUES(1, '음식을 전달받지 못했어요.');
INSERT INTO OBJECTIONWHY(OBJWHY_NO, WHY) VALUES(2, '전달받은 음식에 문제가 있어요.');
INSERT INTO OBJECTIONWHY(OBJWHY_NO, WHY) VALUES(3, '대행자가 부당하게 구매자 과실이라고 신청했어요.');
INSERT INTO OBJECTIONWHY(OBJWHY_NO, WHY) VALUES(4, '기타 사유');

-- MANNERSTICKER
ALTER TABLE MANNERSTICKER MODIFY(NAME VARCHAR2(50));

INSERT INTO MANNERSTICKER(MSTICKER_NO, NAME) VALUES(1, '친절하고 매너가 좋아요.');
INSERT INTO MANNERSTICKER(MSTICKER_NO, NAME) VALUES(2, '약속시간을 잘 지켜요.');
INSERT INTO MANNERSTICKER(MSTICKER_NO, NAME) VALUES(3, '공동구매 진행이 빨라요.');
INSERT INTO MANNERSTICKER(MSTICKER_NO, NAME) VALUES(4, '응답이 빨라요.');

-- REVIEWGRADE
INSERT INTO REVIEWGRADE(REGRADE_NO, NAME) VALUES(1, '최고예요');
INSERT INTO REVIEWGRADE(REGRADE_NO, NAME) VALUES(2, '좋아요');
INSERT INTO REVIEWGRADE(REGRADE_NO, NAME) VALUES(3, '별로예요');

-- GRADE 
INSERT INTO GRADE(GRADE_NO, NAME, SCORE) VALUES(1, '1', 80);
INSERT INTO GRADE(GRADE_NO, NAME, SCORE) VALUES(2, '2', 60);
INSERT INTO GRADE(GRADE_NO, NAME, SCORE) VALUES(3, '3', 40);
INSERT INTO GRADE(GRADE_NO, NAME, SCORE) VALUES(4, '4', 20);
INSERT INTO GRADE(GRADE_NO, NAME, SCORE) VALUES(5, '5', 0);

-- GUIN_MEMBER
INSERT INTO GUIN_MEMBER(GUMEM_NO, MEMBERNAME) VALUES(1, '1');
INSERT INTO GUIN_MEMBER(GUMEM_NO, MEMBERNAME) VALUES(2, '2');
INSERT INTO GUIN_MEMBER(GUMEM_NO, MEMBERNAME) VALUES(3, '3');

-- MENU
INSERT INTO MENU(MENU_NO, MENUNAME) VALUES(1, '한식');
INSERT INTO MENU(MENU_NO, MENUNAME) VALUES(2, '일식');
INSERT INTO MENU(MENU_NO, MENUNAME) VALUES(3, '중식');
INSERT INTO MENU(MENU_NO, MENUNAME) VALUES(4, '양식');
INSERT INTO MENU(MENU_NO, MENUNAME) VALUES(5, '분식');

-- GUIN
INSERT INTO GUIN(GUIN_NO, AC_NO, MENU_NO, SHOP, FOOD, PRICE, DELIVERY, PERIOD, ROADADDR, DETAILADDR, GRADE_NO, COMMENTS, GUMEM_NO)
VALUES(1, 1, 1, '이웃집소녀떡볶이', '떡볶이', 14000, 2500, 25, '서울시 강남구 언주로154길 16', '404동 앞', 5, '떡볶이 2인분', 1);

INSERT INTO GUIN(GUIN_NO, AC_NO, MENU_NO, SHOP, FOOD, PRICE, DELIVERY, PERIOD, ROADADDR, DETAILADDR, GRADE_NO, COMMENTS, GUMEM_NO)
VALUES(2, 1, 2, '보신각', '탕수육과 짜장면', 22000, 3500, 35, '서울시 강남구 언주로159길 2', '건물 앞', 5, '탕짜 진리', 1);

INSERT INTO GUIN(GUIN_NO, AC_NO, MENU_NO, SHOP, FOOD, PRICE, DELIVERY, PERIOD, ROADADDR, DETAILADDR, GRADE_NO, COMMENTS, GUMEM_NO)
VALUES(3, 2, 4, '라르비아따', '파스타', 15000, 3000, 15, '서울시 서대문구 통일로 451', '홍제역 앞', 5, '파스타 먹어용', 1);

-- PAY
INSERT INTO PAY(PAY_NO, PAYNUMBER, PAYMONEY, PAYDATE, GUIN_NO)
VALUES(1, 'PAYNUMBER_1', 8250, SYSDATE, 1);

INSERT INTO PAY(PAY_NO, PAYNUMBER, PAYMONEY, PAYDATE, GUIN_NO)
VALUES(2, 'PAYNUMBER_2', 12750, SYSDATE, 2);

INSERT INTO PAY(PAY_NO, PAYNUMBER, PAYMONEY, PAYDATE, GUIN_NO)
VALUES(3, 'PAYNUMBER유형2!', 9000, SYSDATE, 3);

--------------------------------------------------------------------------------

-- BUYER 제약조건 조회/삭제
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME = 'BUYER';

ALTER TABLE BUYER DROP CONSTRAINT SYS_C007480;

-- BUYER
--1. 판매대행자
INSERT INTO BUYER(BUYER_NO, GUIN_NO, AC_NO, BUYERDATE)
VALUES(1, 1, 1, SYSDATE);

INSERT INTO BUYER(BUYER_NO, GUIN_NO, AC_NO, BUYERDATE)
VALUES(3, 2, 1, SYSDATE);

INSERT INTO BUYER(BUYER_NO, GUIN_NO, AC_NO, BUYERDATE)
VALUES(5, 3, 2, SYSDATE);


--2. 구매자
INSERT INTO BUYER(BUYER_NO, GUIN_NO, AC_NO, BUYERDATE, PAY_NO)
VALUES(2, 1, 2, SYSDATE, 1);

INSERT INTO BUYER(BUYER_NO, GUIN_NO, AC_NO, BUYERDATE, PAY_NO)
VALUES(4, 2, 2, SYSDATE, 2);

INSERT INTO BUYER(BUYER_NO, GUIN_NO, AC_NO, BUYERDATE, PAY_NO)
VALUES(6, 3, 1, SYSDATE, 3);


-- SELLERREVIEW(판매대행자 → 구매자)
INSERT INTO SELLERREVIEW(REVIEW_NO, REGRADE_NO, BUYER_NO, REVIEWDATE, COMMENTS)
VALUES(1, 1, 2, SYSDATE, '좋은 분 ^^');

INSERT INTO SELLERREVIEW(REVIEW_NO, REGRADE_NO, BUYER_NO, REVIEWDATE, COMMENTS)
VALUES(2, 2, 4, SYSDATE, 'ㅎㅎ');

INSERT INTO SELLERREVIEW(REVIEW_NO, REGRADE_NO, BUYER_NO, REVIEWDATE, COMMENTS)
VALUES(3, 1, 6, SYSDATE, '자꾸보네용ㅎ');


--REVIEW(구매자 → 판매대행자)
INSERT INTO REVIEW(REVIEW_NO, REGRADE_NO, BUYER_NO, REVIEWDATE, COMMENTS)
VALUES(1, 3, 2, SYSDATE, 'ㅡㅡ;;;;');

INSERT INTO REVIEW(REVIEW_NO, REGRADE_NO, BUYER_NO, REVIEWDATE, COMMENTS)
VALUES(2, 2, 4, SYSDATE, '잘먹을게요..');

INSERT INTO REVIEW(REVIEW_NO, REGRADE_NO, BUYER_NO, REVIEWDATE, COMMENTS)
VALUES(3, 2, 6, SYSDATE, '잘먹을게요ㅎ;');


-- OBJECTION
INSERT INTO OBJECTION(OBJECTION_NO, BUYER_NO, OBJTYPE_NO, WHY, SINDATE)
VALUES(1, 2, 2, '음식이 이상한데 묵묵부답. 완전 최악 ㅡㅡ', TO_DATE('2021-12-13', 'YYYY-MM-DD')); 


-- 커밋
COMMIT;
